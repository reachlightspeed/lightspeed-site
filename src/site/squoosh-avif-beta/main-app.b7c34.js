(self.webpackJsonp=self.webpackJsonp||[]).push([[2],Array(20).concat([function(e,t,n){"use strict";function o(e,t){for(const n in e)if(e[n]!==t[n])return!1;for(const n in t)if(!(n in e))return!1;return!0}function i(e,t){const n=e.getContext("2d");if(!n)throw Error("Canvas not initialized");n.clearRect(0,0,e.width,e.height),n.putImageData(t,0,0)}async function s(e,t,n){const o=document.createElement("canvas");o.width=e.width,o.height=e.height;const i=o.getContext("2d");if(!i)throw Error("Canvas not initialized");let s;if(i.putImageData(e,0,0),"toBlob"in o)s=await new Promise(e=>o.toBlob(e,t,n));else{const e=o.toDataURL(t,n),i=/data:([^;]+);base64,(.*)$/.exec(e);if(!i)throw Error("Data URL reading failed");const r=i[1],a=atob(i[2]),c=new Uint8Array(a.length);for(let t=0;t<c.length;t+=1)c[t]=a.charCodeAt(t);s=new Blob([c],{type:r})}if(!s)throw Error("Encoding failed");return s}async function r(e){const t=new Image;t.decoding="async",t.src=e;const n=new Promise((e,n)=>{t.onload=()=>e(),t.onerror=()=>n(Error("Image loading error"))});return t.decode&&await t.decode().catch(()=>null),await n,t}function a(e){return r(e).then(()=>!0,()=>!1)}function c(e){return new Response(e).arrayBuffer()}function l(e){return new Response(e).text()}n.d(t,"p",function(){return o}),n.d(t,"f",function(){return i}),n.d(t,"e",function(){return s}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"q",function(){return u}),n.d(t,"b",function(){return p}),n.d(t,"g",function(){return d}),n.d(t,"m",function(){return b}),n.d(t,"n",function(){return g}),n.d(t,"k",function(){return f}),n.d(t,"i",function(){return m}),n.d(t,"h",function(){return v}),n.d(t,"j",function(){return O}),n.d(t,"l",function(){return _}),n.d(t,"r",function(){return y}),n.d(t,"o",function(){return j});const h=new Map([[/^%PDF-/,"application/pdf"],[/^GIF87a/,"image/gif"],[/^GIF89a/,"image/gif"],[/^\x89PNG\x0D\x0A\x1A\x0A/,"image/png"],[/^\xFF\xD8\xFF/,"image/jpeg"],[/^BM/,"image/bmp"],[/^I I/,"image/tiff"],[/^II*/,"image/tiff"],[/^MM\x00*/,"image/tiff"],[/^RIFF....WEBPVP8[LX ]/,"image/webp"],[/^\x00\x00\x00\x20\x66\x74\x79\x70\x61\x76\x69\x66\x00\x00\x00\x00/,"image/avif"]]);async function u(e){const t=await c(e.slice(0,16)),n=Array.from(new Uint8Array(t)).map(e=>String.fromCodePoint(e)).join("");for(const[o,i]of h)if(o.test(n))return i;return""}async function p(e){const t=URL.createObjectURL(e);try{return await r(t)}finally{URL.revokeObjectURL(t)}}function d(e,t={}){const{width:n=e.width,height:o=e.height,sx:i=0,sy:s=0,sw:r=e.width,sh:a=e.height}=t,c=document.createElement("canvas");c.width=n,c.height=o;const l=c.getContext("2d");if(!l)throw new Error("Could not create canvas context");return l.drawImage(e,i,s,r,a,0,0,n,o),l.getImageData(0,0,n,o)}async function b(e){return d("createImageBitmap"in self?await createImageBitmap(e):await p(e))}function g(e,t,n,o,s,r,a,c){const l=document.createElement("canvas");l.width=e.width,l.height=e.height,i(l,e);const h=document.createElement("canvas");h.width=r,h.height=a;const u=h.getContext("2d");if(!u)throw new Error("Could not create canvas context");return"pixelated"===c?u.imageSmoothingEnabled=!1:u.imageSmoothingQuality=c,u.drawImage(l,t,n,o,s,0,0,r,a),u.getImageData(0,0,r,a)}function f(e,t=0){return e?Number(O(e)):t}function m(e,t=0){return e?Number(v(e)):t}function v(e,t=!1){return e?e.checked:t}function O(e,t=""){return e?e.value:t}function _(){return new Promise(e=>{let t="";const n=o=>{"38384040373937396665"===(t=(t+=o.keyCode).slice(-"38384040373937396665".length))&&(window.removeEventListener("keydown",n),e())};window.addEventListener("keydown",n)})}async function y(e,t){const{from:n=e.getBoundingClientRect().height,to:o=e.getBoundingClientRect().height,duration:i=1e3,easing:s="ease-in-out"}=t;if(n!==o&&0!==i)return e.style.height=n+"px",getComputedStyle(e).transform,e.style.transition=`height ${i}ms ${s}`,e.style.height=o+"px",new Promise(t=>{const n=o=>{o.target===e&&(e.style.transition="",e.removeEventListener("transitionend",n),e.removeEventListener("transitioncancel",n),t())};e.addEventListener("transitionend",n),e.addEventListener("transitioncancel",n)});e.style.height=o+"px"}function j(e){e.preventDefault()}},function(e,t,n){e.exports={"options-title":"_bowx",optionsTitle:"_bowx","option-text-first":"_22nOp",optionTextFirst:"_22nOp","option-one-cell":"_3bqd9",optionOneCell:"_3bqd9","option-input-first":"_41Z3W",optionInputFirst:"_41Z3W","section-enabler":"_2bLMv",sectionEnabler:"_2bLMv","options-section":"_2O8o1",optionsSection:"_2O8o1","text-field":"YOpk9",textField:"YOpk9","options-scroller":"HlR3l",optionsScroller:"HlR3l"}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var o=n(20);async function i(e){try{const n=await Object(o.e)(new ImageData(1,1),e);return!!n&&n.type===e}catch(t){return!1}}},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return o}),n.d(t,"label",function(){return i}),n.d(t,"mimeType",function(){return s}),n.d(t,"extension",function(){return r}),n.d(t,"defaultOptions",function(){return a});const o="browser-png",i="Browser PNG",s="image/png",r="png",a={}},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return o}),n.d(t,"label",function(){return i}),n.d(t,"mimeType",function(){return s}),n.d(t,"extension",function(){return r}),n.d(t,"defaultOptions",function(){return a});const o="browser-jpeg",i="Browser JPEG",s="image/jpeg",r="jpg",a={quality:.75}},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return i}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var o=n(22);const i="browser-webp",s="Browser WebP",r="image/webp",a="webp",c={quality:.75},l=()=>Object(o.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return i}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var o=n(22);const i="browser-gif",s="Browser GIF",r="image/gif",a="gif",c={},l=()=>Object(o.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return i}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var o=n(22);const i="browser-tiff",s="Browser TIFF",r="image/tiff",a="tiff",c={},l=()=>Object(o.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return i}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var o=n(22);const i="browser-jp2",s="Browser JPEG 2000",r="image/jp2",a="jp2",c={},l=()=>Object(o.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return i}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var o=n(22);const i="browser-bmp",s="Browser BMP",r="image/bmp",a="bmp",c={},l=()=>Object(o.a)(r)},function(e,t,n){"use strict";n.r(t),n.d(t,"type",function(){return i}),n.d(t,"label",function(){return s}),n.d(t,"mimeType",function(){return r}),n.d(t,"extension",function(){return a}),n.d(t,"defaultOptions",function(){return c}),n.d(t,"featureTest",function(){return l});var o=n(22);const i="browser-pdf",s="Browser PDF",r="application/pdf",a="pdf",c={},l=()=>Object(o.a)(r)},function(e,t,n){e.exports={"two-up-handle":"fKaHr",twoUpHandle:"fKaHr",scrubber:"_1N4rr"}},function(e,t,n){e.exports={results:"_2Za09","result-data":"hc73a",resultData:"hc73a","download-right":"_3XDaq",downloadRight:"_3XDaq","download-left":"_1wmPh",downloadLeft:"_1wmPh","stack-right":"_2I565",stackRight:"_2I565","result-title":"_3ikiG",resultTitle:"_3ikiG","size-delta":"_1eNmr",sizeDelta:"_1eNmr","size-increase":"_21jT-",sizeIncrease:"_21jT-","size-decrease":"_1U8bE",sizeDecrease:"_1U8bE",download:"_1Lw5i","download-link":"_2pDQm",downloadLink:"_2pDQm","action-enter":"_1EMMz",actionEnter:"_1EMMz","download-link-disable":"yznmM",downloadLinkDisable:"yznmM","action-leave":"_1udtV",actionLeave:"_1udtV","download-icon":"_1bBjU",downloadIcon:"_1bBjU","copy-icon":"_9VG14",copyIcon:"_9VG14",spinner:"_2EVrV","copy-to-other":"_1BPNG LdCmd _1Lw5i",copyToOther:"_1BPNG LdCmd _1Lw5i"}},function(e,t,n){e.exports={compress:"_2wucw",options:"_1vnTp","multi-panel":"_1iYR2",multiPanel:"_1iYR2","expand-icon":"qUjf-",expandIcon:"qUjf-"}},function(e,t,n){},function(e,t,n){e.exports={output:"_3wY6x _2H7gL","alt-background":"_2SEwr",altBackground:"_2SEwr","two-up":"_367Xl _2H7gL",twoUp:"_367Xl _2H7gL","pinch-zoom":"_1Bd5a _2H7gL",pinchZoom:"_1Bd5a _2H7gL","pinch-target":"_3P3SZ",pinchTarget:"_3P3SZ",controls:"_3YuEs","zoom-controls":"_17ipg",zoomControls:"_17ipg",button:"_2snFQ",zoom:"_2mErH",active:"lb8rE","zoom-value":"_1FTAH",zoomValue:"_1FTAH",back:"_2_rma","buttons-no-wrap":"_1BEC8",buttonsNoWrap:"_1BEC8"}},function(e,t,n){e.exports={range:"QqOS4","label-text":"_3hiaw",labelText:"_3hiaw","range-wc-container":"_15Ptg",rangeWcContainer:"_15Ptg","range-wc":"_1grfT",rangeWc:"_1grfT","text-input":"nPuUh",textInput:"nPuUh"}},function(e,t,n){e.exports={input:"_2x7lc",thumb:"_1gtTt","thumb-wrapper":"hL76v",thumbWrapper:"hL76v","value-display":"_3JmdS",valueDisplay:"_3JmdS","touch-active":"_3dAl-",touchActive:"_3dAl-"}},function(e,t,n){e.exports={checkbox:"_3LmVE","real-checkbox":"hoUbY",realCheckbox:"hoUbY",icon:"K0_Fo",checked:"_2njZE"}},function(e,t,n){e.exports={"children-exiting":"_3Jzxx",childrenExiting:"_3Jzxx"}},function(e,t,n){e.exports={select:"_1Xahn","native-select":"rBT9o",nativeSelect:"rBT9o",arrow:"fbftt",large:"_19hmM"}},function(e,t){e.exports="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return m});var o=n(44),i=n(20),s=n(56),r=n(45),a=n(46),c=n(47),l=n(48),h=n(49),u=n(50),p=n(51),d=n(52),b=n(2),g=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const f=1e4;class m{constructor(){this._busy=!1,this._latestJobId=0,this._workerTimeoutId=0}static _processingJob(t={}){const{needsWorker:n=!1}=t;return(t,i,s)=>{const r=s.value;s.value=async function(...t){this._latestJobId+=1;const i=this._latestJobId;this.abortCurrent(),n&&self.clearTimeout(this._workerTimeoutId),!this._worker&&n&&(this._worker=new Worker(e,{name:"processor-worker"}),this._workerApi=Object(o.a)(this._worker)),this._busy=!0;const s=Promise.race([r.call(this,...t),new Promise((e,t)=>{this._abortRejector=t})]);return await s.catch(()=>{}),i===this._latestJobId&&this._jobCleanup(),s}}}_jobCleanup(){this._busy=!1,this._worker&&(this._workerTimeoutId=self.setTimeout(this.terminateWorker,f))}abortCurrent(){if(this._busy){if(!this._abortRejector)throw Error("There must be a rejector if it's busy");this._abortRejector(new DOMException("Aborted","AbortError")),this._abortRejector=void 0,this._busy=!1,this.terminateWorker()}}terminateWorker(){this._worker&&(this._worker.terminate(),this._worker=void 0)}imageQuant(e,t){return this._workerApi.quantize(e,t)}rotate(e,t){return this._workerApi.rotate(e,t)}workerResize(e,t){return this._workerApi.resize(e,t)}mozjpegEncode(e,t){return this._workerApi.mozjpegEncode(e,t)}async oxiPngEncode(e,t){const n=await Object(i.e)(e,"image/png"),o=await Object(i.a)(n);return this._workerApi.oxiPngEncode(o,t)}webpEncode(e,t){return this._workerApi.webpEncode(e,t)}async webpDecode(e){const t=await Object(i.a)(e);return this._workerApi.webpDecode(t)}async avifDecode(e){const t=await Object(i.a)(e);return this._workerApi.avifDecode(t)}avifEncode(e,t){return this._workerApi.avifEncode(e,t)}browserBmpEncode(e){return r.a(e)}browserPngEncode(e){return a.a(e)}browserJpegEncode(e,t){return c.a(e,t)}browserWebpEncode(e,t){return l.a(e,t)}browserGifEncode(e){return h.a(e)}browserTiffEncode(e){return u.a(e)}browserJp2Encode(e){return p.a(e)}browserPdfEncode(e){return d.a(e)}resize(e,t){return this.abortCurrent(),Object(s.a)(e,t)}vectorResize(e,t){return this.abortCurrent(),Object(s.b)(e,t)}}g([b.b],m.prototype,"terminateWorker",null),g([m._processingJob({needsWorker:!0})],m.prototype,"imageQuant",null),g([m._processingJob({needsWorker:!0})],m.prototype,"rotate",null),g([m._processingJob({needsWorker:!0})],m.prototype,"workerResize",null),g([m._processingJob({needsWorker:!0})],m.prototype,"mozjpegEncode",null),g([m._processingJob({needsWorker:!0})],m.prototype,"oxiPngEncode",null),g([m._processingJob({needsWorker:!0})],m.prototype,"webpEncode",null),g([m._processingJob({needsWorker:!0})],m.prototype,"webpDecode",null),g([m._processingJob({needsWorker:!0})],m.prototype,"avifDecode",null),g([m._processingJob({needsWorker:!0})],m.prototype,"avifEncode",null),g([m._processingJob()],m.prototype,"browserBmpEncode",null),g([m._processingJob()],m.prototype,"browserPngEncode",null),g([m._processingJob()],m.prototype,"browserJpegEncode",null),g([m._processingJob()],m.prototype,"browserWebpEncode",null),g([m._processingJob()],m.prototype,"browserGifEncode",null),g([m._processingJob()],m.prototype,"browserTiffEncode",null),g([m._processingJob()],m.prototype,"browserJp2Encode",null),g([m._processingJob()],m.prototype,"browserPdfEncode",null)}).call(this,n(43))},function(e,t,n){e.exports=n.p+"processor-worker.ee876.worker.js"},function(e,t,n){"use strict";n.d(t,"a",function(){return l});const o=["ArrayBuffer","MessagePort","OffscreenCanvas"].filter(e=>e in self).map(e=>self[e]),i=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),s=Symbol("proxyValue"),r=Symbol("throw"),a=new Map([["PROXY",{canHandle:e=>e&&e[s],serialize:e=>{const{port1:t,port2:n}=new MessageChannel;return function(e,t){m(t)&&(t=d(t));if(!b(t))throw Error("endpoint does not have all of addEventListener, removeEventListener and postMessage defined");g(t),f(t,async function(n){if(!n.data.id||!n.data.callPath)return;const o=n.data;let i=await o.callPath.slice(0,-1).reduce((e,t)=>e[t],e),c=await o.callPath.reduce((e,t)=>e[t],e),l=c,h=[];if("APPLY"!==o.type&&"CONSTRUCT"!==o.type||(h=o.argumentsList.map(u)),"APPLY"===o.type)try{l=await c.apply(i,h)}catch(p){(l=p)[r]=!0}if("CONSTRUCT"===o.type)try{l=function(e){return e[s]=!0,e}(l=new c(...h))}catch(p){(l=p)[r]=!0}return"SET"===o.type&&(c[o.property]=o.value,l=!0),(l=function(e){for(const[t,n]of a)if(n.canHandle(e)){const o=n.serialize(e);return{value:{type:t,value:o}}}return{value:{type:"RAW",value:e}}}(l)).id=o.id,t.postMessage(l,_([l]))})}(e,t),n},deserialize:e=>l(e)}],["THROW",{canHandle:e=>e&&e[r],serialize:e=>{const t=e&&e.message,n=e&&e.stack;return Object.assign({},e,{message:t,stack:n})},deserialize:e=>{throw Object.assign(Error(),e)}}]]);let c=0;function l(e,t){if(m(e)&&(e=d(e)),!b(e))throw Error("endpoint does not have all of addEventListener, removeEventListener and postMessage defined");return g(e),function e(t,n=[],o=function(){}){return new Proxy(o,{construct:(e,o,i)=>t({type:"CONSTRUCT",callPath:n,argumentsList:o}),apply:(o,i,s)=>"bind"===n[n.length-1]?e(t,n.slice(0,-1)):t({type:"APPLY",callPath:n,argumentsList:s}),get(o,i,s){if("then"===i&&0===n.length)return{then:()=>s};if("then"===i){const e=t({type:"GET",callPath:n});return Promise.resolve(e).then.bind(e)}return e(t,n.concat(i),o[i])},set:(e,o,i,s)=>t({type:"SET",callPath:n,property:o,value:i})})}(async t=>{let n=[];return"APPLY"!==t.type&&"CONSTRUCT"!==t.type||(n=t.argumentsList.map(h)),u((await function(e,t,n){const o=`${i}-${c++}`;return new Promise(i=>{f(e,function t(n){n.data.id===o&&(!function(e,t){e.removeEventListener("message",t)}(e,t),i(n))}),t=Object.assign({},t,{id:o}),e.postMessage(t,n)})}(e,Object.assign({},t,{argumentsList:n}),_(n))).data.value)},[],t)}function h(e){for(const[n,o]of a)if(o.canHandle(e))return{type:n,value:o.serialize(e)};let t=[];for(const n of O(e))for(const[e,o]of a)o.canHandle(n.value)&&t.push({path:n.path,wrappedValue:{type:e,value:o.serialize(n.value)}});for(const n of t){n.path.slice(0,-1).reduce((e,t)=>e[t],e)[n.path[n.path.length-1]]=null}return{type:"RAW",value:e,wrappedChildren:t}}function u(e){if(a.has(e.type)){return a.get(e.type).deserialize(e.value)}if(function(e){return"RAW"===e.type}(e)){for(const t of e.wrappedChildren||[]){if(!a.has(t.wrappedValue.type))throw Error(`Unknown value type "${e.type}" at ${t.path.join(".")}`);const n=a.get(t.wrappedValue.type).deserialize(t.wrappedValue.value);p(e.value,t.path,n)}return e.value}throw Error(`Unknown value type "${e.type}"`)}function p(e,t,n){const o=t.slice(-1)[0];t.slice(0,-1).reduce((e,t)=>e[t],e)[o]=n}function d(e){if("Window"!==self.constructor.name)throw Error("self is not a window");return{addEventListener:self.addEventListener.bind(self),removeEventListener:self.removeEventListener.bind(self),postMessage:(t,n)=>e.postMessage(t,"*",n)}}function b(e){return"addEventListener"in e&&"removeEventListener"in e&&"postMessage"in e}function g(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.start()}function f(e,t){e.addEventListener("message",t)}function m(e){return["window","length","location","parent","opener"].every(t=>t in e)}function v(e){return o.some(t=>e instanceof t)}function*O(e,t=[],n=null){if(!e)return;if(n||(n=new WeakSet),n.has(e))return;if("string"==typeof e)return;if("object"==typeof e&&n.add(e),ArrayBuffer.isView(e))return;yield{value:e,path:t};const o=Object.keys(e);for(const i of o)yield*O(e[i],[...t,i],n)}function _(e){const t=[];for(const n of O(e))v(n.value)&&t.push(n.value);return t}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(29),i=n(20);function s(e){return Object(i.e)(e,o.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(23),i=n(20);function s(e){return Object(i.e)(e,o.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(24),i=n(20);function s(e,{quality:t}){return Object(i.e)(e,o.mimeType,t)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(25),i=n(20);function s(e,{quality:t}){return Object(i.e)(e,o.mimeType,t)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(26),i=n(20);function s(e){return Object(i.e)(e,o.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(27),i=n(20);function s(e){return Object(i.e)(e,o.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(28),i=n(20);function s(e){return Object(i.e)(e,o.mimeType)}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(30),i=n(20);function s(e){return Object(i.e)(e,o.mimeType)}},function(e,t,n){e.exports={"panel-heading":"ED-CD",panelHeading:"ED-CD","panel-content":"_10baD",panelContent:"_10baD"}},function(e,t,n){"use strict";const o=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],i=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=(e,t)=>{let n=e;return"string"==typeof t?n=e.toLocaleString(t):!0===t&&(n=e.toLocaleString()),n};e.exports=(e,t)=>{if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const n=(t=Object.assign({bits:!1},t)).bits?i:o;if(t.signed&&0===e)return" 0 "+n[0];const r=e<0,a=r?"-":t.signed?"+":"";if(r&&(e=-e),e<1){return a+s(e,t.locale)+" "+n[0]}const c=Math.min(Math.floor(Math.log10(e)/3),n.length-1);return e=Number((e/Math.pow(1e3,c)).toPrecision(3)),a+s(e,t.locale)+" "+n[c]}},,function(e,t,n){"use strict";var o=n(20);function i(e,t,n,o){const i=n/o;if(i>e/t){const n=e/i;return{sw:e,sh:n,sx:0,sy:(t-n)/2}}const s=t*i;return{sh:t,sw:s,sx:(e-s)/2,sy:0}}function s(e,t){let n=0,s=0,r=e.width,a=e.height;return"contain"===t.fitMethod&&({sx:n,sy:s,sw:r,sh:a}=i(r,a,t.width,t.height)),Object(o.n)(e,n,s,r,a,t.width,t.height,t.method.slice("browser-".length))}function r(e,t){let n=0,s=0,r=e.width,a=e.height;return"contain"===t.fitMethod&&({sx:n,sy:s,sw:r,sh:a}=i(r,a,t.width,t.height)),Object(o.g)(e,{sx:n,sy:s,sw:r,sh:a,width:t.width,height:t.height})}n.d(t,"a",function(){return s}),n.d(t,"b",function(){return r})},,function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"MozJpegColorSpace",function(){return ie}),n.d(o,"type",function(){return ce}),n.d(o,"label",function(){return le}),n.d(o,"mimeType",function(){return he}),n.d(o,"extension",function(){return ue}),n.d(o,"defaultOptions",function(){return pe});var i={};n.r(i),n.d(i,"WebPImageHint",function(){return Ce}),n.d(i,"type",function(){return xe}),n.d(i,"label",function(){return Pe}),n.d(i,"mimeType",function(){return Se}),n.d(i,"extension",function(){return ke}),n.d(i,"defaultOptions",function(){return ze});var s={};n.r(s),n.d(s,"type",function(){return Ve}),n.d(s,"label",function(){return Ne}),n.d(s,"defaultOptions",function(){return Ye});var r={};n.r(r),n.d(r,"type",function(){return Ge}),n.d(r,"label",function(){return Je}),n.d(r,"mimeType",function(){return Ze}),n.d(r,"extension",function(){return Xe}),n.d(r,"defaultOptions",function(){return Qe});var a={};n.r(a),n.d(a,"type",function(){return Ke}),n.d(a,"label",function(){return et}),n.d(a,"mimeType",function(){return tt}),n.d(a,"extension",function(){return nt}),n.d(a,"defaultOptions",function(){return ot});var c=n(0),l=n(2),h=n(20),u=n(33);class p{constructor(e){this.id=-1,this.nativePointer=e,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY,self.Touch&&e instanceof Touch?this.id=e.identifier:d(e)&&(this.id=e.pointerId)}getCoalesced(){return"getCoalescedEvents"in this.nativePointer?this.nativePointer.getCoalescedEvents().map(e=>new p(e)):[this]}}const d=e=>self.PointerEvent&&e instanceof PointerEvent,b=()=>{};var g=class{constructor(e,t){this._element=e,this.startPointers=[],this.currentPointers=[];const{start:n=(()=>!0),move:o=b,end:i=b}=t;this._startCallback=n,this._moveCallback=o,this._endCallback=i,this._pointerStart=this._pointerStart.bind(this),this._touchStart=this._touchStart.bind(this),this._move=this._move.bind(this),this._triggerPointerEnd=this._triggerPointerEnd.bind(this),this._pointerEnd=this._pointerEnd.bind(this),this._touchEnd=this._touchEnd.bind(this),self.PointerEvent?this._element.addEventListener("pointerdown",this._pointerStart):(this._element.addEventListener("mousedown",this._pointerStart),this._element.addEventListener("touchstart",this._touchStart),this._element.addEventListener("touchmove",this._move),this._element.addEventListener("touchend",this._touchEnd))}_triggerPointerStart(e,t){return!!this._startCallback(e,t)&&(this.currentPointers.push(e),this.startPointers.push(e),!0)}_pointerStart(e){0===e.button&&this._triggerPointerStart(new p(e),e)&&(d(e)?(this._element.setPointerCapture(e.pointerId),this._element.addEventListener("pointermove",this._move),this._element.addEventListener("pointerup",this._pointerEnd)):(window.addEventListener("mousemove",this._move),window.addEventListener("mouseup",this._pointerEnd)))}_touchStart(e){for(const t of Array.from(e.changedTouches))this._triggerPointerStart(new p(t),e)}_move(e){const t=this.currentPointers.slice(),n="changedTouches"in e?Array.from(e.changedTouches).map(e=>new p(e)):[new p(e)],o=[];for(const i of n){const e=this.currentPointers.findIndex(e=>e.id===i.id);-1!==e&&(o.push(i),this.currentPointers[e]=i)}0!==o.length&&this._moveCallback(t,o,e)}_triggerPointerEnd(e,t){const n=this.currentPointers.findIndex(t=>t.id===e.id);return-1!==n&&(this.currentPointers.splice(n,1),this.startPointers.splice(n,1),this._endCallback(e,t),!0)}_pointerEnd(e){if(this._triggerPointerEnd(new p(e),e))if(d(e)){if(this.currentPointers.length)return;this._element.removeEventListener("pointermove",this._move),this._element.removeEventListener("pointerup",this._pointerEnd)}else window.removeEventListener("mousemove",this._move),window.removeEventListener("mouseup",this._pointerEnd)}_touchEnd(e){for(const t of Array.from(e.changedTouches))this._triggerPointerEnd(new p(t),e)}};n(34);function f(e,t){return t?Math.sqrt((t.clientX-e.clientX)**2+(t.clientY-e.clientY)**2):0}function m(e,t){return t?{clientX:(e.clientX+t.clientX)/2,clientY:(e.clientY+t.clientY)/2}:e}function v(e,t){return"number"==typeof e?e:e.trimRight().endsWith("%")?t*parseFloat(e)/100:parseFloat(e)}let O;function _(){return O||(O=document.createElementNS("http://www.w3.org/2000/svg","svg"))}function y(){return _().createSVGMatrix()}function j(){return _().createSVGPoint()}const w=.01;customElements.define("pinch-zoom",class extends HTMLElement{constructor(){super(),this._transform=y(),new MutationObserver(()=>this._stageElChange()).observe(this,{childList:!0});const e=new g(this,{start:(t,n)=>!(2===e.currentPointers.length||!this._positioningEl||(n.preventDefault(),0)),move:t=>{this._onPointerMove(t,e.currentPointers)}});this.addEventListener("wheel",e=>this._onWheel(e))}connectedCallback(){this._stageElChange()}get x(){return this._transform.e}get y(){return this._transform.f}get scale(){return this._transform.a}scaleTo(e,t={}){let{originX:n=0,originY:o=0}=t;const{relativeTo:i="content",allowChangeEvent:s=!1}=t,r="content"===i?this._positioningEl:this;if(!r||!this._positioningEl)return void this.setTransform({scale:e,allowChangeEvent:s});const a=r.getBoundingClientRect();if(n=v(n,a.width),o=v(o,a.height),"content"===i)n+=this.x,o+=this.y;else{const e=this._positioningEl.getBoundingClientRect();n-=e.left,o-=e.top}this._applyChange({allowChangeEvent:s,originX:n,originY:o,scaleDiff:e/this.scale})}setTransform(e={}){const{scale:t=this.scale,allowChangeEvent:n=!1}=e;let{x:o=this.x,y:i=this.y}=e;if(!this._positioningEl)return void this._updateTransform(t,o,i,n);const s=this.getBoundingClientRect(),r=this._positioningEl.getBoundingClientRect();if(!s.width||!s.height)return void this._updateTransform(t,o,i,n);let a=j();a.x=r.left-s.left,a.y=r.top-s.top;let c=j();c.x=r.width+a.x,c.y=r.height+a.y;const l=y().translate(o,i).scale(t).multiply(this._transform.inverse());a=a.matrixTransform(l),c=c.matrixTransform(l),a.x>s.width?o+=s.width-a.x:c.x<0&&(o+=-c.x),a.y>s.height?i+=s.height-a.y:c.y<0&&(i+=-c.y),this._updateTransform(t,o,i,n)}_updateTransform(e,t,n,o){if(!(e<w)&&(e!==this.scale||t!==this.x||n!==this.y)&&(this._transform.e=t,this._transform.f=n,this._transform.d=this._transform.a=e,this.style.setProperty("--x",this.x+"px"),this.style.setProperty("--y",this.y+"px"),this.style.setProperty("--scale",this.scale+""),o)){const e=new Event("change",{bubbles:!0});this.dispatchEvent(e)}}_stageElChange(){this._positioningEl=void 0,0!==this.children.length&&(this._positioningEl=this.children[0],this.children.length>1&&console.warn("<pinch-zoom> must not have more than one child."),this.setTransform({allowChangeEvent:!0}))}_onWheel(e){if(!this._positioningEl)return;e.preventDefault();const t=this._positioningEl.getBoundingClientRect();let{deltaY:n}=e;const{ctrlKey:o,deltaMode:i}=e;1===i&&(n*=15);const s=1-n/(o?100:300);this._applyChange({scaleDiff:s,originX:e.clientX-t.left,originY:e.clientY-t.top,allowChangeEvent:!0})}_onPointerMove(e,t){if(!this._positioningEl)return;const n=this._positioningEl.getBoundingClientRect(),o=m(e[0],e[1]),i=m(t[0],t[1]),s=o.clientX-n.left,r=o.clientY-n.top,a=f(e[0],e[1]),c=f(t[0],t[1]),l=a?c/a:1;this._applyChange({originX:s,originY:r,scaleDiff:l,panX:i.clientX-o.clientX,panY:i.clientY-o.clientY,allowChangeEvent:!0})}_applyChange(e={}){const{panX:t=0,panY:n=0,originX:o=0,originY:i=0,scaleDiff:s=1,allowChangeEvent:r=!1}=e,a=y().translate(t,n).translate(o,i).translate(this.x,this.y).scale(s).translate(-o,-i).scale(this.scale);this.setTransform({allowChangeEvent:r,scale:a.a,x:a.e,y:a.f})}});var C=n(31);const E="legacy-clip-compat",x="orientation";customElements.define("two-up",class extends HTMLElement{constructor(){super(),this._handle=document.createElement("div"),this._position=0,this._relativePosition=.5,this._positionOnPointerStart=0,this._everConnected=!1,this._handle.className=C.twoUpHandle,new MutationObserver(()=>this._childrenChange()).observe(this,{childList:!0}),"ResizeObserver"in window?new ResizeObserver(()=>this._resetPosition()).observe(this):window.addEventListener("resize",()=>this._resetPosition());const e=new g(this._handle,{start:(t,n)=>1!==e.currentPointers.length&&(n.preventDefault(),this._positionOnPointerStart=this._position,!0),move:()=>{this._pointerChange(e.startPointers[0],e.currentPointers[0])}})}static get observedAttributes(){return[x]}connectedCallback(){this._childrenChange(),this._handle.innerHTML=`<div class="${C.scrubber}"><svg viewBox="0 0 27 20" fill="currentColor"><path d="M17 19.2l9.5-9.6L16.9 0zM9.6 0L0 9.6l9.6 9.6z"/></svg></div>`,this._everConnected||(this._resetPosition(),this._everConnected=!0)}attributeChangedCallback(e){e===x&&this._resetPosition()}_resetPosition(){requestAnimationFrame(()=>{const e=this.getBoundingClientRect(),t="vertical"===this.orientation?"height":"width";this._position=e[t]*this._relativePosition,this._setPosition()})}get legacyClipCompat(){return this.hasAttribute(E)}set legacyClipCompat(e){e?this.setAttribute(E,""):this.removeAttribute(E)}get orientation(){const e=this.getAttribute(x);return e&&"vertical"===e.toLowerCase()?"vertical":"horizontal"}set orientation(e){this.setAttribute(x,e)}_childrenChange(){this.lastElementChild!==this._handle&&this.appendChild(this._handle)}_pointerChange(e,t){const n="vertical"===this.orientation?"clientY":"clientX",o="vertical"===this.orientation?"height":"width",i=this.getBoundingClientRect();this._position=this._positionOnPointerStart+(t[n]-e[n]),this._position=Math.max(0,Math.min(this._position,i[o])),this._relativePosition=this._position/i[o],this._setPosition()}_setPosition(){this.style.setProperty("--split-point",`${this._position}px`)}});var P=n(35),S=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n};const k=e=>Object(c.b)("svg",Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},e)),z=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-7h-2zm-6 .7l2.6-2.6 1.4 1.4-5 5-5-5 1.4-1.4 2.6 2.6V3h2z"})),T=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm2 4v-2H3c0 1.1.9 2 2 2zM3 9h2V7H3v2zm12 12h2v-2h-2v2zm4-18H9a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm0 12H9V5h10v10zm-8 6h2v-2h-2v2zm-4 0h2v-2H7v2z"})),I=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M9 7H7v2h2V7zm0 4H7v2h2v-2zm0-8a2 2 0 0 0-2 2h2V3zm4 12h-2v2h2v-2zm6-12v2h2a2 2 0 0 0-2-2zm-6 0h-2v2h2V3zM9 17v-2H7c0 1.1.9 2 2 2zm10-4h2v-2h-2v2zm0-4h2V7h-2v2zm0 8a2 2 0 0 0 2-2h-2v2zM5 7H3v12c0 1.1.9 2 2 2h12v-2H5V7zm10-2h2V3h-2v2zm0 12h2v-2h-2v2z"})),A=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M15.6 5.5L11 1v3a8 8 0 0 0 0 16v-2a6 6 0 0 1 0-12v4l4.5-4.5zm4.3 5.5a8 8 0 0 0-1.6-3.9L17 8.5c.5.8.9 1.6 1 2.5h2zM13 17.9v2a8 8 0 0 0 3.9-1.6L15.5 17c-.8.5-1.6.9-2.5 1zm3.9-2.4l1.4 1.4A8 8 0 0 0 20 13h-2c-.1.9-.5 1.7-1 2.5z"})),R=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})),L=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M19 13H5v-2h14v2z"})),M=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M21.3 2.7v18.6H2.7V2.7h18.6m0-2.7H2.7A2.7 2.7 0 0 0 0 2.7v18.6A2.7 2.7 0 0 0 2.7 24h18.6a2.7 2.7 0 0 0 2.7-2.7V2.7A2.7 2.7 0 0 0 21.3 0z"})),D=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M21.3 0H2.7A2.7 2.7 0 0 0 0 2.7v18.6A2.7 2.7 0 0 0 2.7 24h18.6a2.7 2.7 0 0 0 2.7-2.7V2.7A2.7 2.7 0 0 0 21.3 0zm-12 18.7L2.7 12l1.8-1.9L9.3 15 19.5 4.8l1.8 1.9z"})),B=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M16.6 8.6L12 13.2 7.4 8.6 6 10l6 6 6-6z"})),H=e=>Object(c.b)(k,Object.assign({},e),Object(c.b)("path",{d:"M20 11H7.8l5.6-5.6L12 4l-8 8 8 8 1.4-1.4L7.8 13H20v-2z"})),q={up:90,right:180,down:-90,left:0},F=e=>{const{copyDirection:t}=e,n=S(e,["copyDirection"]),o="point-"+t,i=q[t];return Object(c.b)(k,Object.assign({},n),Object(c.b)("defs",null,Object(c.b)("clipPath",{id:o},Object(c.b)("path",{d:"M-12-12v24h24v-24zM4.5 2h-4v3l-5-5 5-5v3h4z",transform:`translate(12 13) rotate(${i})`}))),Object(c.b)("path",{"clip-path":`url(#${o})`,d:"M19 3h-4.2c-.4-1.2-1.5-2-2.8-2s-2.4.8-2.8 2H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm-7 0a1 1 0 0 1 0 2c-.6 0-1-.4-1-1s.4-1 1-1z"}))};function W(e,t,n,o){const i=Array.isArray(t)?t:(""+t).split(".");let s=U(e);const r=s,a=i.length-1;for(const[c,l]of i.entries())c!==a?s=s[l]=U(s[l]):s[l]=o?Object.assign(U(s[l]),n):n;return r}function U(e){return Array.isArray(e)?[...e]:Object.assign({},e)}function $(e,t,n){return W(e,t,n,!0)}function V(e,t,n){return W(e,t,n,!1)}var N=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const Y={originX:"50%",originY:"50%",relativeTo:"container",allowChangeEvent:!0};class G extends c.a{constructor(){super(...arguments),this.state={scale:1,editingScale:!1,altBackground:!1},this.retargetedEvents=new WeakSet}componentDidMount(){const e=this.leftDrawable(),t=this.rightDrawable();this.pinchZoomLeft.setTransform({allowChangeEvent:!0,x:0,y:0,scale:1}),this.canvasLeft&&e&&Object(h.f)(this.canvasLeft,e),this.canvasRight&&t&&Object(h.f)(this.canvasRight,t)}componentDidUpdate(e,t){const n=this.leftDrawable(e),o=this.rightDrawable(e),i=this.leftDrawable(),s=this.rightDrawable(),r=!!this.props.source!=!!e.source||this.props.source&&e.source&&this.props.source.file!==e.source.file,a=e.source&&e.source.processed,c=this.props.source&&this.props.source.processed,l=this.pinchZoomLeft;if(r)l.setTransform({allowChangeEvent:!0,x:0,y:0,scale:1});else if(a&&c&&a!==c){const e=1-l.scale,t=a.width/2*e,n=a.height/2*e;l.setTransform({allowChangeEvent:!0,x:l.x-t+n,y:l.y-n+t})}i&&i!==n&&this.canvasLeft&&Object(h.f)(this.canvasLeft,i),s&&s!==o&&this.canvasRight&&Object(h.f)(this.canvasRight,s)}shouldComponentUpdate(e,t){return!Object(h.p)(this.props,e)||!Object(h.p)(this.state,t)}leftDrawable(e=this.props){return e.leftCompressed||e.source&&e.source.processed}rightDrawable(e=this.props){return e.rightCompressed||e.source&&e.source.processed}toggleBackground(){this.setState({altBackground:!this.state.altBackground})}zoomIn(){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(1.25*this.state.scale,Y)}zoomOut(){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(this.state.scale/1.25,Y)}onRotateClick(){const{inputProcessorState:e}=this.props;if(!e)return;const t=V(e,"rotate.rotate",(e.rotate.rotate+90)%360);this.props.onInputProcessorChange(t)}onScaleValueFocus(){this.setState({editingScale:!0},()=>{this.scaleInput&&(getComputedStyle(this.scaleInput).transform,this.scaleInput.focus())})}onScaleInputBlur(){this.setState({editingScale:!1})}onScaleInputChanged(e){const t=e.target,n=parseFloat(t.value);if(!isNaN(n)){if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.pinchZoomLeft.scaleTo(n/100,Y)}}onPinchZoomLeftChange(e){if(!this.pinchZoomRight||!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");this.setState({scale:this.pinchZoomLeft.scale}),this.pinchZoomRight.setTransform({scale:this.pinchZoomLeft.scale,x:this.pinchZoomLeft.x,y:this.pinchZoomLeft.y})}onRetargetableEvent(e){const t=e.target;if(!this.pinchZoomLeft)throw Error("Missing pinch-zoom element");if("wheel"!==e.type&&t.closest(`.${C.twoUpHandle}`))return;if(this.retargetedEvents.has(e))return;e.stopImmediatePropagation(),e.preventDefault();const n=new e.constructor(e.type,e);this.retargetedEvents.add(n),this.pinchZoomLeft.dispatchEvent(n),"touchend"===e.type&&document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur()}render({mobileView:e,leftImgContain:t,rightImgContain:n,source:o,onBack:i},{scale:s,editingScale:r,altBackground:a}){const h=this.leftDrawable(),u=this.rightDrawable(),p=o&&o.processed;return Object(c.b)("div",{class:`${P.output} ${a?P.altBackground:""}`},Object(c.b)("two-up",{"legacy-clip-compat":!0,class:P.twoUp,orientation:e?"vertical":"horizontal",onTouchStartCapture:this.onRetargetableEvent,onTouchEndCapture:this.onRetargetableEvent,onTouchMoveCapture:this.onRetargetableEvent,onPointerDownCapture:this.onRetargetableEvent,onMouseDownCapture:this.onRetargetableEvent,onWheelCapture:this.onRetargetableEvent},Object(c.b)("pinch-zoom",{class:P.pinchZoom,onChange:this.onPinchZoomLeftChange,ref:Object(l.c)(this,"pinchZoomLeft")},Object(c.b)("canvas",{class:P.pinchTarget,ref:Object(l.c)(this,"canvasLeft"),width:h&&h.width,height:h&&h.height,style:{width:p&&p.width,height:p&&p.height,objectFit:t?"contain":""}})),Object(c.b)("pinch-zoom",{class:P.pinchZoom,ref:Object(l.c)(this,"pinchZoomRight")},Object(c.b)("canvas",{class:P.pinchTarget,ref:Object(l.c)(this,"canvasRight"),width:u&&u.width,height:u&&u.height,style:{width:p&&p.width,height:p&&p.height,objectFit:n?"contain":""}}))),Object(c.b)("div",{class:P.back},Object(c.b)("button",{class:P.button,onClick:i},Object(c.b)(H,null))),Object(c.b)("div",{class:P.controls},Object(c.b)("div",{class:P.zoomControls},Object(c.b)("button",{class:P.button,onClick:this.zoomOut},Object(c.b)(L,null)),r?Object(c.b)("input",{type:"number",step:"1",min:"1",max:"1000000",ref:Object(l.c)(this,"scaleInput"),class:P.zoom,value:Math.round(100*s),onInput:this.onScaleInputChanged,onBlur:this.onScaleInputBlur}):Object(c.b)("span",{class:P.zoom,tabIndex:0,onFocus:this.onScaleValueFocus},Object(c.b)("span",{class:P.zoomValue},Math.round(100*s)),"%"),Object(c.b)("button",{class:P.button,onClick:this.zoomIn},Object(c.b)(R,null))),Object(c.b)("div",{class:P.buttonsNoWrap},Object(c.b)("button",{class:P.button,onClick:this.onRotateClick,title:"Rotate image"},Object(c.b)(A,null)),Object(c.b)("button",{class:`${P.button} ${a?P.active:""}`,onClick:this.toggleBackground,title:"Change canvas color"},a?Object(c.b)(I,null):Object(c.b)(T,null)))))}}N([l.b],G.prototype,"toggleBackground",null),N([l.b],G.prototype,"zoomIn",null),N([l.b],G.prototype,"zoomOut",null),N([l.b],G.prototype,"onRotateClick",null),N([l.b],G.prototype,"onScaleValueFocus",null),N([l.b],G.prototype,"onScaleInputBlur",null),N([l.b],G.prototype,"onScaleInputChanged",null),N([l.b],G.prototype,"onPinchZoomLeftChange",null),N([l.b],G.prototype,"onRetargetableEvent",null);var J=n(21),Z=n(36),X=n(37),Q=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const K=["focus","blur"],ee=["input","change"],te=["name","min","max","step","value","disabled"],ne=["name","min","max","step","value","disabled"];class oe extends HTMLElement{constructor(){super(),this._ignoreChange=!1,this._input=document.createElement("input"),this._input.type="range",this._input.className=X.input;const e=new g(this._input,{start:()=>0===e.currentPointers.length&&(this._input.classList.add(X.touchActive),!0),end:()=>{this._input.classList.remove(X.touchActive)}});for(const t of K)this._input.addEventListener(t,this._retargetEvent,!0);for(const t of ee)this._input.addEventListener(t,this._update,!0)}static get observedAttributes(){return ne}connectedCallback(){this.contains(this._input)||(this.innerHTML=`<div class="${X.thumbWrapper}">`+`<div class="${X.thumb}"></div>`+`<div class="${X.valueDisplay}"></div>`+"</div>",this.insertBefore(this._input,this.firstChild),this._valueDisplay=this.querySelector("."+X.valueDisplay),this._update())}get labelPrecision(){return this.getAttribute("label-precision")||""}set labelPrecision(e){this.setAttribute("label-precision",e)}attributeChangedCallback(e,t,n){this._ignoreChange||(null===n?this._input.removeAttribute(e):this._input.setAttribute(e,n),this._reflectAttributes(),this._update())}_retargetEvent(e){e.stopImmediatePropagation();const t=new Event(e.type,e);this.dispatchEvent(t)}_update(){const e=Number(this.value)||0,t=Number(this.min)||0,n=Number(this.max)||100,o=Number(this.labelPrecision)||function(e){const t=e.split(".")[1];return t?t.length:0}(this.step)||0,i=100*(e-t)/(n-t),s=o?e.toFixed(o):Math.round(e).toString();this._valueDisplay.textContent=s,this.style.setProperty("--value-percent",i+"%"),this.style.setProperty("--value-width",""+s.length)}_reflectAttributes(){this._ignoreChange=!0;for(const e of ne)this._input.hasAttribute(e)?this.setAttribute(e,this._input.getAttribute(e)):this.removeAttribute(e);this._ignoreChange=!1}}Q([l.b],oe.prototype,"_retargetEvent",null),Q([l.b],oe.prototype,"_update",null);for(const Vt of te)Object.defineProperty(oe.prototype,Vt,{get(){return this._input[Vt]},set(e){this._input[Vt]=e,this._reflectAttributes(),this._update()}});customElements.define("range-input",oe);var ie,se=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n};class re extends c.a{onTextInput(e){const t=e.target;if(!t.value.trim())return;this.rangeWc.value=t.value;const{onInput:n}=this.props;n&&n(e)}render(e){const{children:t}=e,n=se(e,["children"]),{value:o,min:i,max:s,step:r}=e;return Object(c.b)("label",{class:Z.range},Object(c.b)("span",{class:Z.labelText},t),Object(c.b)("div",{class:Z.rangeWcContainer},Object(c.b)("range-input",Object.assign({ref:Object(l.c)(this,"rangeWc"),class:Z.rangeWc},n))),Object(c.b)("input",{type:"number",class:Z.textInput,value:o,min:i,max:s,step:r,onInput:this.onTextInput}))}}(function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],re.prototype,"onTextInput",null);class ae extends c.a{onChange(e){const t=e.currentTarget.closest("form"),n={level:Object(h.k)(t.level)};this.props.onChange(n)}render({options:e}){return Object(c.b)("form",{class:J.optionsSection,onSubmit:h.o},Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"level",min:"0",max:"3",step:"1",value:e.level,onInput:this.onChange},"Effort:")))}}(function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],ae.prototype,"onChange",null),function(e){e[e.GRAYSCALE=1]="GRAYSCALE",e[e.RGB=2]="RGB",e[e.YCbCr=3]="YCbCr"}(ie||(ie={}));const ce="mozjpeg",le="MozJPEG",he="image/jpeg",ue="jpg",pe={quality:75,baseline:!1,arithmetic:!1,progressive:!0,optimize_coding:!0,smoothing:0,color_space:ie.YCbCr,quant_table:3,trellis_multipass:!1,trellis_opt_zero:!1,trellis_opt_table:!1,trellis_loops:1,auto_subsample:!0,chroma_subsample:2,separate_chroma_quality:!1,chroma_quality:75};var de=n(38);class be extends c.a{render(e){return Object(c.b)("div",{class:de.checkbox},e.checked?Object(c.b)(D,{class:`${de.icon} ${de.checked}`}):Object(c.b)(M,{class:de.icon}),Object(c.b)("input",Object.assign({class:de.realCheckbox,type:"checkbox"},e)))}}var ge=n(39);class fe extends c.a{constructor(){super(...arguments),this.state={outgoingChildren:[]},this.lastElHeight=0}componentWillReceiveProps(e){const t=this.props.children;!e.children[0]&&t[0]&&this.setState({outgoingChildren:t})}componentWillUpdate(e){const t=this.props.children,n=e.children;t[0]&&n[0]||!t[0]&&!n[0]||(this.lastElHeight=this.base.getBoundingClientRect().height)}async componentDidUpdate(e){const t=this.props.children,n=e.children;if(t[0]&&n[0]||!t[0]&&!n[0])return;this.base.style.height="",this.base.style.overflow="hidden";const o=t[0]?this.base.getBoundingClientRect().height:0;await Object(h.r)(this.base,{duration:300,from:this.lastElHeight,to:o}),this.base.style.height="",this.base.style.overflow="",this.state.outgoingChildren[0]&&this.setState({outgoingChildren:[]})}render(e,{outgoingChildren:t}){const n=e.children,o=!n[0]&&t[0];return Object(c.b)("div",{class:o?ge.childrenExiting:""},n[0]?n:t)}}var me=n(40),ve=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n};class Oe extends c.a{render(e){const{large:t}=e,n=ve(e,["large"]);return Object(c.b)("div",{class:me.select},Object(c.b)("select",Object.assign({class:`${me.nativeSelect} ${t?me.large:""}`},n)),Object(c.b)("svg",{class:me.arrow,viewBox:"0 0 10 5"},Object(c.b)("path",{d:"M0 0l5 5 5-5z"})))}}var _e=function(e,t,n){var o=t.split("."),i=e.__lsc||(e.__lsc={});return i[t+n]||(i[t+n]=function(t){for(var i=t&&t.target||this,s={},r=s,a="string"==typeof n?function(e,t,n,o){for(o=0,t=t.split?t.split("."):t;e&&o<t.length;)e=e[t[o++]];return void 0===e?n:e}(t,n):i.nodeName?i.type.match(/^che|rad/)?i.checked:i.value:t,c=0;c<o.length-1;c++)r=r[o[c]]||(r[o[c]]=!c&&e.state[o[c]]||{});r[o[c]]=a,e.setState(s)})};class ye extends c.a{constructor(){super(...arguments),this.state={showAdvanced:!1}}onChange(e){const t=e.currentTarget.closest("form"),{options:n}=this.props,o=Object.assign({},this.props.options,{baseline:Object(h.h)(t.baseline,n.baseline),progressive:Object(h.h)(t.progressive,n.progressive),optimize_coding:Object(h.h)(t.optimize_coding,n.optimize_coding),trellis_multipass:Object(h.h)(t.trellis_multipass,n.trellis_multipass),trellis_opt_zero:Object(h.h)(t.trellis_opt_zero,n.trellis_opt_zero),trellis_opt_table:Object(h.h)(t.trellis_opt_table,n.trellis_opt_table),auto_subsample:Object(h.h)(t.auto_subsample,n.auto_subsample),separate_chroma_quality:Object(h.h)(t.separate_chroma_quality,n.separate_chroma_quality),quality:Object(h.k)(t.quality,n.quality),chroma_quality:Object(h.k)(t.chroma_quality,n.chroma_quality),chroma_subsample:Object(h.k)(t.chroma_subsample,n.chroma_subsample),smoothing:Object(h.k)(t.smoothing,n.smoothing),color_space:Object(h.k)(t.color_space,n.color_space),quant_table:Object(h.k)(t.quant_table,n.quant_table),trellis_loops:Object(h.k)(t.trellis_loops,n.trellis_loops)});this.props.onChange(o)}render({options:e},{showAdvanced:t}){return Object(c.b)("form",{class:J.optionsSection,onSubmit:h.o},Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"quality",min:"0",max:"100",value:e.quality,onInput:this.onChange},"Quality:")),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{checked:t,onChange:_e(this,"showAdvanced")}),"Show advanced settings"),Object(c.b)(fe,null,t?Object(c.b)("div",null,Object(c.b)("label",{class:J.optionTextFirst},"Channels:",Object(c.b)(Oe,{name:"color_space",value:e.color_space,onChange:this.onChange},Object(c.b)("option",{value:ie.GRAYSCALE},"Grayscale"),Object(c.b)("option",{value:ie.RGB},"RGB"),Object(c.b)("option",{value:ie.YCbCr},"YCbCr"))),Object(c.b)(fe,null,e.color_space===ie.YCbCr?Object(c.b)("div",null,Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"auto_subsample",checked:e.auto_subsample,onChange:this.onChange}),"Auto subsample chroma"),Object(c.b)(fe,null,e.auto_subsample?null:Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"chroma_subsample",min:"1",max:"4",value:e.chroma_subsample,onInput:this.onChange},"Subsample chroma by:"))),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"separate_chroma_quality",checked:e.separate_chroma_quality,onChange:this.onChange}),"Separate chroma quality"),Object(c.b)(fe,null,e.separate_chroma_quality?Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"chroma_quality",min:"0",max:"100",value:e.chroma_quality,onInput:this.onChange},"Chroma quality:")):null)):null),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"baseline",checked:e.baseline,onChange:this.onChange}),"Pointless spec compliance"),Object(c.b)(fe,null,e.baseline?null:Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"progressive",checked:e.progressive,onChange:this.onChange}),"Progressive rendering")),Object(c.b)(fe,null,e.baseline?Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"optimize_coding",checked:e.optimize_coding,onChange:this.onChange}),"Optimize Huffman table"):null),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"smoothing",min:"0",max:"100",value:e.smoothing,onInput:this.onChange},"Smoothing:")),Object(c.b)("label",{class:J.optionTextFirst},"Quantization:",Object(c.b)(Oe,{name:"quant_table",value:e.quant_table,onChange:this.onChange},Object(c.b)("option",{value:"0"},"JPEG Annex K"),Object(c.b)("option",{value:"1"},"Flat"),Object(c.b)("option",{value:"2"},"MSSIM-tuned Kodak"),Object(c.b)("option",{value:"3"},"ImageMagick"),Object(c.b)("option",{value:"4"},"PSNR-HVS-M-tuned Kodak"),Object(c.b)("option",{value:"5"},"Klein et al"),Object(c.b)("option",{value:"6"},"Watson et al"),Object(c.b)("option",{value:"7"},"Ahumada et al"),Object(c.b)("option",{value:"8"},"Peterson et al"))),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"trellis_multipass",checked:e.trellis_multipass,onChange:this.onChange}),"Trellis multipass"),Object(c.b)(fe,null,e.trellis_multipass?Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"trellis_opt_zero",checked:e.trellis_opt_zero,onChange:this.onChange}),"Optimize zero block runs"):null),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"trellis_opt_table",checked:e.trellis_opt_table,onChange:this.onChange}),"Optimize after trellis quantization"),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"trellis_loops",min:"1",max:"50",value:e.trellis_loops,onInput:this.onChange},"Trellis quantization passes:"))):null))}}(function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],ye.prototype,"onChange",null);var je=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};function we(e={}){const{min:t=0,max:n=100,step:o=1}=e;class i extends c.a{onChange(e){const t=e.currentTarget;this.props.onChange({quality:Number(t.value)})}render({options:e}){return Object(c.b)("div",{class:J.optionsSection},Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"quality",min:t,max:n,step:o||"any",value:e.quality,onInput:this.onChange},"Quality:")))}}return je([l.b],i.prototype,"onChange",null),i}var Ce,Ee=we({min:0,max:1,step:.01});!function(e){e[e.WEBP_HINT_DEFAULT=0]="WEBP_HINT_DEFAULT",e[e.WEBP_HINT_PICTURE=1]="WEBP_HINT_PICTURE",e[e.WEBP_HINT_PHOTO=2]="WEBP_HINT_PHOTO",e[e.WEBP_HINT_GRAPH=3]="WEBP_HINT_GRAPH"}(Ce||(Ce={}));const xe="webp",Pe="WebP",Se="image/webp",ke="webp",ze={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0};const Te=[[0,0],[1,20],[2,25],[3,30],[3,50],[4,50],[4,75],[4,90],[5,90],[6,100]],Ie=6;function Ae(e,t){const n=Te.findIndex(([n,o])=>n===t&&o===e);return-1!==n?n:Ie}class Re extends c.a{constructor(){super(...arguments),this.state={showAdvanced:!1}}onChange(e){const t=e.currentTarget.closest("form"),n=Object(h.i)(t.lossless),{options:o}=this.props,i=Object(h.k)(t.lossless_preset,Ae(o.quality,o.method)),s=Object.assign({},o,{lossless:n,quality:n?Te[i][1]:Object(h.k)(t.quality,o.quality),method:n?Te[i][0]:Object(h.k)(t.method_input,o.method),image_hint:Object(h.i)(t.image_hint,o.image_hint)?Ce.WEBP_HINT_GRAPH:Ce.WEBP_HINT_DEFAULT,exact:Object(h.i)(t.exact,o.exact),alpha_compression:Object(h.i)(t.alpha_compression,o.alpha_compression),autofilter:Object(h.i)(t.autofilter,o.autofilter),filter_type:Object(h.i)(t.filter_type,o.filter_type),use_sharp_yuv:Object(h.i)(t.use_sharp_yuv,o.use_sharp_yuv),near_lossless:100-Object(h.k)(t.near_lossless,100-o.near_lossless),alpha_quality:Object(h.k)(t.alpha_quality,o.alpha_quality),alpha_filtering:Object(h.k)(t.alpha_filtering,o.alpha_filtering),sns_strength:Object(h.k)(t.sns_strength,o.sns_strength),filter_strength:Object(h.k)(t.filter_strength,o.filter_strength),filter_sharpness:7-Object(h.k)(t.filter_sharpness,7-o.filter_sharpness),pass:Object(h.k)(t.pass,o.pass),preprocessing:Object(h.k)(t.preprocessing,o.preprocessing),segments:Object(h.k)(t.segments,o.segments),partitions:Object(h.k)(t.partitions,o.partitions)});this.props.onChange(s)}_losslessSpecificOptions(e){return Object(c.b)("div",{key:"lossless"},Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"lossless_preset",min:"0",max:"9",value:Ae(e.quality,e.method),onInput:this.onChange},"Effort:")),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"near_lossless",min:"0",max:"100",value:""+(100-e.near_lossless),onInput:this.onChange},"Slight loss:")),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"image_hint",checked:e.image_hint===Ce.WEBP_HINT_GRAPH,onChange:this.onChange}),"Discrete tone image"))}_lossySpecificOptions(e){const{showAdvanced:t}=this.state;return Object(c.b)("div",{key:"lossy"},Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"method_input",min:"0",max:"6",value:e.method,onInput:this.onChange},"Effort:")),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"quality",min:"0",max:"100",step:"0.1",value:e.quality,onInput:this.onChange},"Quality:")),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{checked:t,onChange:_e(this,"showAdvanced")}),"Show advanced settings"),Object(c.b)(fe,null,t?Object(c.b)("div",null,Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"alpha_compression",checked:!!e.alpha_compression,onChange:this.onChange}),"Compress alpha"),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"alpha_quality",min:"0",max:"100",value:e.alpha_quality,onInput:this.onChange},"Alpha quality:")),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"alpha_filtering",min:"0",max:"2",value:e.alpha_filtering,onInput:this.onChange},"Alpha filter quality:")),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"autofilter",checked:!!e.autofilter,onChange:this.onChange}),"Auto adjust filter strength"),Object(c.b)(fe,null,e.autofilter?null:Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"filter_strength",min:"0",max:"100",value:e.filter_strength,onInput:this.onChange},"Filter strength:"))),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"filter_type",checked:!!e.filter_type,onChange:this.onChange}),"Strong filter"),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"filter_sharpness",min:"0",max:"7",value:7-e.filter_sharpness,onInput:this.onChange},"Filter sharpness:")),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"use_sharp_yuv",checked:!!e.use_sharp_yuv,onChange:this.onChange}),"Sharp RGBYUV conversion"),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"pass",min:"1",max:"10",value:e.pass,onInput:this.onChange},"Passes:")),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"sns_strength",min:"0",max:"100",value:e.sns_strength,onInput:this.onChange},"Spatial noise shaping:")),Object(c.b)("label",{class:J.optionTextFirst},"Preprocess:",Object(c.b)(Oe,{name:"preprocessing",value:e.preprocessing,onChange:this.onChange},Object(c.b)("option",{value:"0"},"None"),Object(c.b)("option",{value:"1"},"Segment smooth"),Object(c.b)("option",{value:"2"},"Pseudo-random dithering"))),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"segments",min:"1",max:"4",value:e.segments,onInput:this.onChange},"Segments:")),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"partitions",min:"0",max:"3",value:e.partitions,onInput:this.onChange},"Partitions:"))):null))}render({options:e}){return Object(c.b)("form",{class:J.optionsSection,onSubmit:h.o},Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"lossless",checked:!!e.lossless,onChange:this.onChange}),"Lossless"),e.lossless?this._losslessSpecificOptions(e):this._lossySpecificOptions(e),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"exact",checked:!!e.exact,onChange:this.onChange}),"Preserve transparent data"))}}(function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],Re.prototype,"onChange",null);class Le extends c.a{constructor(){super(...arguments),this.state={}}onChange(e){const t=e.currentTarget.closest("form"),{options:n}=this.props,o=Object.assign({},this.props.options,{minQuantizer:Object(h.k)(t.quantizer,n.minQuantizer),maxQuantizer:Object(h.k)(t.quantizer,n.maxQuantizer),speed:Object(h.k)(t.speed,n.speed)});this.props.onChange(o)}render({options:e}){return Object(c.b)("form",{class:J.optionsSection,onSubmit:h.o},Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"quantizer",min:"0",max:"63",value:e.minQuantizer,onInput:this.onChange},"Quantizer")),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"speed",min:"0",max:"10",value:e.speed,onInput:this.onChange},"Speed")))}}(function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);s>3&&r&&Object.defineProperty(t,n,r)})([l.b],Le.prototype,"onChange",null);var Me=we({min:0,max:1,step:.01}),De=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const Be=Object(h.l)();class He extends c.a{constructor(){super(...arguments),this.state={extendedSettings:!1}}componentDidMount(){Be.then(()=>{this.setState({extendedSettings:!0})})}onChange(e){const t=e.currentTarget.closest("form"),{options:n}=this.props,o={zx:Object(h.k)(t.zx,n.zx),maxNumColors:Object(h.k)(t.maxNumColors,n.maxNumColors),dither:Object(h.k)(t.dither)};this.props.onChange(o)}render({options:e},{extendedSettings:t}){return Object(c.b)("form",{class:J.optionsSection,onSubmit:h.o},Object(c.b)(fe,null,t?Object(c.b)("label",{class:J.optionTextFirst},"Type:",Object(c.b)(Oe,{name:"zx",value:""+e.zx,onChange:this.onChange},Object(c.b)("option",{value:"0"},"Standard"),Object(c.b)("option",{value:"1"},"ZX"))):null),Object(c.b)(fe,null,e.zx?null:Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"maxNumColors",min:"2",max:"256",value:e.maxNumColors,onInput:this.onChange},"Colors:"))),Object(c.b)("div",{class:J.optionOneCell},Object(c.b)(re,{name:"dither",min:"0",max:"1",step:"0.01",value:e.dither,onInput:this.onChange},"Dithering:")))}}De([l.b],He.prototype,"onChange",null);const qe=["triangle","catrom","mitchell","lanczos3","hqx"];function Fe(e){return qe.includes(e.method)}var We=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const Ue=[.25,.3333,.5,1,2,3,4];class $e extends c.a{constructor(e){super(e),this.state={maintainAspect:!0},this.presetWidths={},this.presetHeights={},this.generatePresetValues(e.inputWidth,e.inputHeight)}reportOptions(){const e=this.form,t=e.width,n=e.height,{options:o}=this.props;if(!t.checkValidity()||!n.checkValidity())return;const i={width:Object(h.k)(t),height:Object(h.k)(n),method:e.resizeMethod.value,premultiply:Object(h.h)(e.premultiply,!0),linearRGB:Object(h.h)(e.linearRGB,!0),fitMethod:Object(h.j)(e.fitMethod,o.fitMethod)};this.props.onChange(i)}onChange(){this.reportOptions()}getAspect(){return this.props.inputWidth/this.props.inputHeight}componentDidUpdate(e,t){!t.maintainAspect&&this.state.maintainAspect&&(this.form.height.value=Math.round(Number(this.form.width.value)/this.getAspect()),this.reportOptions())}componentWillReceiveProps(e){this.props.inputWidth===e.inputWidth&&this.props.inputHeight===e.inputHeight||this.generatePresetValues(e.inputWidth,e.inputHeight)}onWidthInput(){if(this.state.maintainAspect){const e=Object(h.k)(this.form.width);this.form.height.value=Math.round(e/this.getAspect())}this.reportOptions()}onHeightInput(){if(this.state.maintainAspect){const e=Object(h.k)(this.form.height);this.form.width.value=Math.round(e*this.getAspect())}this.reportOptions()}generatePresetValues(e,t){for(const n of Ue)this.presetWidths[n]=Math.round(e*n),this.presetHeights[n]=Math.round(t*n)}getPreset(){const{width:e,height:t}=this.props.options;for(const n of Ue)if(e===this.presetWidths[n]&&t===this.presetHeights[n])return n;return"custom"}onPresetChange(e){const t=e.target;if("custom"===t.value)return;const n=Number(t.value);this.form.width.value=Math.round(this.props.inputWidth*n)+"",this.form.height.value=Math.round(this.props.inputHeight*n)+"",this.reportOptions()}render({options:e,isVector:t},{maintainAspect:n}){return Object(c.b)("form",{ref:Object(l.c)(this,"form"),class:J.optionsSection,onSubmit:h.o},Object(c.b)("label",{class:J.optionTextFirst},"Method:",Object(c.b)(Oe,{name:"resizeMethod",value:e.method,onChange:this.onChange},t&&Object(c.b)("option",{value:"vector"},"Vector"),Object(c.b)("option",{value:"lanczos3"},"Lanczos3"),Object(c.b)("option",{value:"mitchell"},"Mitchell"),Object(c.b)("option",{value:"catrom"},"Catmull-Rom"),Object(c.b)("option",{value:"triangle"},"Triangle (bilinear)"),Object(c.b)("option",{value:"hqx"},"hqx (pixel art)"),Object(c.b)("option",{value:"browser-pixelated"},"Browser pixelated"),Object(c.b)("option",{value:"browser-low"},"Browser low quality"),Object(c.b)("option",{value:"browser-medium"},"Browser medium quality"),Object(c.b)("option",{value:"browser-high"},"Browser high quality"))),Object(c.b)("label",{class:J.optionTextFirst},"Preset:",Object(c.b)(Oe,{value:this.getPreset(),onChange:this.onPresetChange},Ue.map(e=>Object(c.b)("option",{value:e},100*e,"%")),Object(c.b)("option",{value:"custom"},"Custom"))),Object(c.b)("label",{class:J.optionTextFirst},"Width:",Object(c.b)("input",{required:!0,class:J.textField,name:"width",type:"number",min:"1",value:""+e.width,onInput:this.onWidthInput})),Object(c.b)("label",{class:J.optionTextFirst},"Height:",Object(c.b)("input",{required:!0,class:J.textField,name:"height",type:"number",min:"1",value:""+e.height,onInput:this.onHeightInput})),Object(c.b)(fe,null,Fe(e)?Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"premultiply",checked:e.premultiply,onChange:this.onChange}),"Premultiply alpha channel"):null,Fe(e)?Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"linearRGB",checked:e.linearRGB,onChange:this.onChange}),"Linear RGB"):null),Object(c.b)("label",{class:J.optionInputFirst},Object(c.b)(be,{name:"maintainAspect",checked:n,onChange:_e(this,"maintainAspect")}),"Maintain aspect ratio"),Object(c.b)(fe,null,n?null:Object(c.b)("label",{class:J.optionTextFirst},"Fit method:",Object(c.b)(Oe,{name:"fitMethod",value:e.fitMethod,onChange:this.onChange},Object(c.b)("option",{value:"stretch"},"Stretch"),Object(c.b)("option",{value:"contain"},"Contain")))))}}We([l.b],$e.prototype,"onChange",null),We([l.b],$e.prototype,"onWidthInput",null),We([l.b],$e.prototype,"onHeightInput",null),We([l.b],$e.prototype,"onPresetChange",null);const Ve="identity",Ne="Original image",Ye={},Ge="png",Je="OxiPNG",Ze="image/png",Xe="png",Qe={level:2},Ke="avif",et="AVIF",tt="image/avif",nt="avif",ot={minQuantizer:16,maxQuantizer:16,tileColsLog2:0,tileRowsLog2:0,speed:10,subsample:0};var it=n(23),st=n(24),rt=n(25),at=n(26),ct=n(27),lt=n(28),ht=n(29),ut=n(30);const pt={[Ve]:s,[Ge]:r,[ce]:o,[xe]:i,[Ke]:a,[it.type]:it,[st.type]:st,[rt.type]:rt,[ht.type]:ht,[at.type]:at,[ct.type]:ct,[lt.type]:lt,[ut.type]:ut},dt=Array.from(Object.values(pt)),bt=Promise.resolve().then(async()=>{const e={};return await Promise.all(dt.map(async t=>{const n=!("featureTest"in t)||await t.featureTest();e[t.type]=n})),e});var gt=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const ft={[Ve]:void 0,[Ge]:ae,[ce]:ye,[xe]:Re,[Ke]:Le,[it.type]:void 0,[st.type]:Ee,[rt.type]:Me,[ht.type]:void 0,[at.type]:void 0,[ct.type]:void 0,[lt.type]:void 0,[ut.type]:void 0};class mt extends c.a{constructor(){super(),this.state={encoderSupportMap:void 0},bt.then(e=>this.setState({encoderSupportMap:e}))}onEncoderTypeChange(e){const t=e.currentTarget.value;this.props.onEncoderTypeChange(t)}onPreprocessorEnabledChange(e){const t=e.currentTarget,n=t.name.split(".")[0];this.props.onPreprocessorOptionsChange(V(this.props.preprocessorState,`${n}.enabled`,t.checked))}onQuantizerOptionsChange(e){this.props.onPreprocessorOptionsChange($(this.props.preprocessorState,"quantizer",e))}onResizeOptionsChange(e){this.props.onPreprocessorOptionsChange($(this.props.preprocessorState,"resize",e))}render({source:e,encoderState:t,preprocessorState:n,onEncoderOptionsChange:o},{encoderSupportMap:i}){const s=ft[t.type];return Object(c.b)("div",{class:J.optionsScroller},Object(c.b)(fe,null,t.type===Ve?null:Object(c.b)("div",null,Object(c.b)("h3",{class:J.optionsTitle},"Edit"),Object(c.b)("label",{class:J.sectionEnabler},Object(c.b)(be,{name:"resize.enable",checked:!!n.resize.enabled,onChange:this.onPreprocessorEnabledChange}),"Resize"),Object(c.b)(fe,null,n.resize.enabled?Object(c.b)($e,{isVector:Boolean(e&&e.vectorImage),inputWidth:e?e.processed.width:1,inputHeight:e?e.processed.height:1,options:n.resize,onChange:this.onResizeOptionsChange}):null),Object(c.b)("label",{class:J.sectionEnabler},Object(c.b)(be,{name:"quantizer.enable",checked:!!n.quantizer.enabled,onChange:this.onPreprocessorEnabledChange}),"Reduce palette"),Object(c.b)(fe,null,n.quantizer.enabled?Object(c.b)(He,{options:n.quantizer,onChange:this.onQuantizerOptionsChange}):null))),Object(c.b)("h3",{class:J.optionsTitle},"Compress"),Object(c.b)("section",{class:`${J.optionOneCell} ${J.optionsSection}`},i?Object(c.b)(Oe,{value:t.type,onChange:this.onEncoderTypeChange,large:!0},dt.filter(e=>i[e.type]).map(e=>Object(c.b)("option",{value:e.type},e.label))):Object(c.b)(Oe,{large:!0},Object(c.b)("option",null,"Loading"))),Object(c.b)(fe,null,s?Object(c.b)(s,{options:t.options,onChange:o}):null))}}gt([l.b],mt.prototype,"onEncoderTypeChange",null),gt([l.b],mt.prototype,"onPreprocessorEnabledChange",null),gt([l.b],mt.prototype,"onQuantizerOptionsChange",null),gt([l.b],mt.prototype,"onResizeOptionsChange",null);const vt=5;class Ot{constructor(){this._entries=[]}add(e){if(e.encoderState.type===Ve)throw Error("Cannot cache identity encodes");this._entries.unshift(e),this._entries.length>vt&&this._entries.pop()}match(e,t,n){const o=this._entries.findIndex(o=>{if(o.sourceData!==e)return!1;if(o.encoderState.type!==n.type)return!1;for(const e in t)if(!Object(h.p)(t[e],o.preprocessorState[e]))return!1;return!!Object(h.p)(n.options,o.encoderState.options)});if(-1===o)return;const i=this._entries[o];return 0!==o&&(this._entries.splice(o,1),this._entries.unshift(i)),{data:i.data,preprocessed:i.preprocessed,file:i.file}}}const _t={quantizer:Object.assign({enabled:!1},{zx:0,maxNumColors:256,dither:1}),resize:Object.assign({enabled:!1},{width:1,height:1,method:"lanczos3",fitMethod:"stretch",premultiply:!0,linearRGB:!0})};var yt=n(41),jt=n.n(yt);const wt=Object(h.d)(jt.a);async function Ct(e,t){const n=await Object(h.q)(e);try{return"image/avif"===n?await t.avifDecode(e):"image/webp"!==n||await wt?await Object(h.m)(e):await t.webpDecode(e)}catch(o){throw Error("Couldn't decode image")}}var Et=n(42),xt=n(53);const Pt="open-one-only";function St(e){const t=e.closest("multi-panel > *, a, button");if(t&&t.classList.contains(xt.panelHeading))return t}async function kt(e){const t=e.nextElementSibling;if(!t)return;const n=t.getBoundingClientRect().height;e.removeAttribute("content-expanded"),t.setAttribute("aria-expanded","false"),await null,await Object(h.r)(t,{from:n,to:0,duration:300}),t.style.height=""}customElements.define("multi-panel",class extends HTMLElement{static get observedAttributes(){return[Pt]}constructor(){super(),this.addEventListener("click",this._onClick),this.addEventListener("keydown",this._onKeyDown),new MutationObserver(()=>this._childrenChange()).observe(this,{childList:!0})}connectedCallback(){this._childrenChange()}attributeChangedCallback(e,t,n){e===Pt&&null===n&&this._closeAll({exceptFirst:!0})}_onClick(e){const t=St(e.target);t&&this._toggle(t)}_onKeyDown(e){const t=document.activeElement,n=St(t);if(!n)return;if(t!==n)return;if(e.altKey)return;let o;switch(e.key){case"ArrowLeft":case"ArrowUp":o=this._prevHeading();break;case"ArrowRight":case"ArrowDown":o=this._nextHeading();break;case"Home":o=this._firstHeading();break;case"End":o=this._lastHeading();break;case"Enter":case" ":case"Spacebar":this._toggle(n);break;default:return}e.preventDefault(),o&&(t.setAttribute("tabindex","-1"),o.setAttribute("tabindex","0"),o.focus())}_toggle(e){e&&(e.hasAttribute("content-expanded")?kt(e):(this.openOneOnly&&this._closeAll(),async function(e){const t=e.nextElementSibling;if(!t)return;const n=t.getBoundingClientRect().height;e.setAttribute("content-expanded",""),t.setAttribute("aria-expanded","true");const o=t.getBoundingClientRect().height;await null,await Object(h.r)(t,{from:n,to:o,duration:300}),t.style.height=""}(e)))}_closeAll(e={}){const{exceptFirst:t=!1}=e;let n=[...this.children].filter(e=>e.matches("[content-expanded]"));t&&(n=n.slice(1));for(const o of n)kt(o)}_childrenChange(){let e=!1,t=this.firstElementChild;for(;t;){const n=t.nextElementSibling,o=Math.random().toString(36).substr(2,9);if(!n){console.error("<multi-panel> requires an even number of element children.");break}t.classList.remove(xt.panelContent),n.classList.remove(xt.panelHeading),t.removeAttribute("aria-expanded"),t.removeAttribute("content-expanded"),n.removeAttribute("tabindex"),t.classList.add(xt.panelHeading),n.classList.add(xt.panelContent),t.id=`panel-heading-${o}`,t.setAttribute("aria-controls",`panel-content-${o}`),n.id=`panel-content-${o}`,n.setAttribute("aria-labelledby",`panel-heading-${o}`),"0"===t.getAttribute("tabindex")?e=!0:t.setAttribute("tabindex","-1"),n.setAttribute("aria-expanded",t.hasAttribute("content-expanded")?"true":"false"),t=n.nextElementSibling}!e&&this.firstElementChild&&this.firstElementChild.setAttribute("tabindex","0"),this.openOneOnly&&this._closeAll({exceptFirst:!0})}_prevHeading(){if(this.firstElementChild===document.activeElement)return this.firstElementChild;const e=document.activeElement.previousElementSibling;return e?e.previousElementSibling:void 0}_nextHeading(){const e=document.activeElement.nextElementSibling;if(e)return e.nextElementSibling}_firstHeading(){return this.firstElementChild}_lastHeading(){const e=this.lastElementChild;if(e&&e.classList.contains(xt.panelHeading))return e;const t=this.lastElementChild;return t?t.previousElementSibling:void 0}get openOneOnly(){return this.hasAttribute(Pt)}set openOneOnly(e){e?this.setAttribute(Pt,""):this.removeAttribute(Pt)}});var zt=n(32),Tt=n(54);class It extends c.a{render({blob:e,compareTo:t}){let n;if(t){const o=e.size/t.size;if(o>1){const e=Math.round(100*(o-1))+"%";n=Object(c.b)("span",{class:`${zt.sizeDelta} ${zt.sizeIncrease}`},"0%"===e?"slightly":e," bigger")}else if(o<1){const e=Math.round(100*(1-o))+"%";n=Object(c.b)("span",{class:`${zt.sizeDelta} ${zt.sizeDecrease}`},"0%"===e?"slightly":e," smaller")}else n=Object(c.b)("span",{class:zt.sizeDelta},"no change")}return Object(c.b)("span",null,Tt(e.size)," ",n)}}n(8);var At=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const Rt={"stack-right":zt.stackRight,"download-right":zt.downloadRight,"download-left":zt.downloadLeft},Lt=500;class Mt extends c.a{constructor(){super(...arguments),this.state={showLoadingState:!1},this.loadingTimeoutId=0}componentDidUpdate(e,t){e.loading&&!this.props.loading?(clearTimeout(this.loadingTimeoutId),this.setState({showLoadingState:!1})):!e.loading&&this.props.loading&&(this.loadingTimeoutId=self.setTimeout(()=>this.setState({showLoadingState:!0}),Lt))}onCopyToOtherClick(e){e.preventDefault(),this.props.onCopyToOtherClick()}onDownload(){const e=Math.round(this.props.source.file.size/1024),t=Math.round(this.props.imageFile.size/1024),n=Math.round(t/e*1e3);ga("send","event","compression","download",{metric1:e,metric2:t,metric3:n})}render({source:e,imageFile:t,downloadUrl:n,children:o,copyDirection:i,buttonPosition:s},{showLoadingState:r}){return Object(c.b)("div",{class:`${zt.results} ${Rt[s]}`},Object(c.b)("div",{class:zt.resultData},o[0]?Object(c.b)("div",{class:zt.resultTitle},o):null,!t||r?"Working":Object(c.b)(It,{blob:t,compareTo:e&&t!==e.file?e.file:void 0})),Object(c.b)("button",{class:zt.copyToOther,title:"Copy settings to other side",onClick:this.onCopyToOtherClick},Object(c.b)(F,{class:zt.copyIcon,copyDirection:i})),Object(c.b)("div",{class:zt.download},n&&t&&Object(c.b)("a",{class:`${zt.downloadLink} ${r?zt.downloadLinkDisable:""}`,href:n,download:t.name,title:"Download",onClick:this.onDownload},Object(c.b)(z,{class:zt.downloadIcon})),r&&Object(c.b)("loading-spinner",{class:zt.spinner})))}}At([l.b],Mt.prototype,"onCopyToOtherClick",null),At([l.b],Mt.prototype,"onDownload",null);const Dt={rotate:{rotate:0}};n.d(t,"default",function(){return $t});var Bt=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};async function Ht(e,t,n){let o=e;return 0!==t.rotate.rotate&&(o=await n.rotate(o,t.rotate)),o}function qt(e,t){let n=Object.assign({},e);for(const o of[0,1]){const t=e.sides[o].downloadUrl;t&&URL.revokeObjectURL(t),n=$(e,`sides.${o}`,{preprocessed:void 0,file:void 0,downloadUrl:void 0,data:void 0,encodedSettings:void 0})}return n}const Ft=["Top","Bottom"],Wt=["download-left","download-right"],Ut=document.title;class $t extends c.a{constructor(e){super(e),this.widthQuery=window.matchMedia("(max-width: 599px)"),this.state={source:void 0,loading:!1,loadingCounter:0,sides:[{latestSettings:{preprocessorState:_t,encoderState:{type:Ve,options:Ye}},loadingCounter:0,loadedCounter:0,loading:!1},{latestSettings:{preprocessorState:_t,encoderState:{type:ce,options:pe}},loadingCounter:0,loadedCounter:0,loading:!1}],mobileView:this.widthQuery.matches},this.encodeCache=new Ot,this.leftProcessor=new Et.a,this.rightProcessor=new Et.a,this.updateImageTimeoutIds=[void 0,void 0],this.widthQuery.addListener(this.onMobileWidthChange),this.updateFile(e.file),n.e(0).then(n.bind(null,57)).then(({mainAppLoaded:e})=>e())}onMobileWidthChange(){this.setState({mobileView:this.widthQuery.matches})}onEncoderTypeChange(e,t){this.setState({sides:V(this.state.sides,`${e}.latestSettings.encoderState`,{type:t,options:pt[t].defaultOptions})})}onPreprocessorOptionsChange(e,t){this.setState({sides:V(this.state.sides,`${e}.latestSettings.preprocessorState`,t)})}onEncoderOptionsChange(e,t){this.setState({sides:V(this.state.sides,`${e}.latestSettings.encoderState.options`,t)})}updateDocumentTitle(e=""){document.title=e?`${e} - ${Ut}`:Ut}componentWillReceiveProps(e){e.file!==this.props.file&&this.updateFile(e.file)}componentWillUnmount(){this.updateDocumentTitle()}componentDidUpdate(e,t){const{source:n,sides:o}=this.state,i=!!n!=!!t.source||n&&t.source&&n.processed!==t.source.processed;for(const[s,r]of o.entries()){const e=t.sides[s].latestSettings,n=r.latestSettings.encoderState!==e.encoderState,o=r.latestSettings.preprocessorState!==e.preprocessorState;(i||n||o)&&this.queueUpdateImage(s,{skipPreprocessing:!i&&!o})}}async onCopyToOtherClick(e){const t=(e+1)%2,n=this.state.sides[t],o=Object.assign({},this.state.sides[e]);o.file&&(o.downloadUrl=URL.createObjectURL(o.file)),this.setState({sides:V(this.state.sides,t,o)}),"undo"===await this.props.showSnack("Settings copied across",{timeout:5e3,actions:["undo","dismiss"]})&&this.setState({sides:V(this.state.sides,t,n)})}async onInputProcessorChange(e){const t=this.state.source;if(!t)return;const n=t.inputProcessorState.rotate.rotate%180!=e.rotate.rotate%180,o=this.state.loadingCounter+1,i=this.leftProcessor;this.setState({loadingCounter:o,loading:!0,source:V(t,"inputProcessorState",e)}),this.leftProcessor.abortCurrent(),this.rightProcessor.abortCurrent();try{const r=await Ht(t.decoded,e,i);if(this.state.loadingCounter!==o)return;let a=Object.assign({},this.state,{loading:!1});if(a=qt(a=V(a,"source.processed",r),a.source),n)for(const e of[0,1]){const t=a.sides[e].latestSettings.preprocessorState.resize;a=$(a,`sides.${e}.latestSettings.preprocessorState.resize`,{width:t.height,height:t.width})}this.setState(a)}catch(s){if("AbortError"===s.name)return;if(console.error(s),this.state.loadingCounter!==o)return;this.props.showSnack("Processing error"),this.setState({loading:!1})}}async updateFile(e){const t=this.state.loadingCounter+1,n=this.leftProcessor;this.setState({loadingCounter:t,loading:!0}),this.leftProcessor.abortCurrent(),this.rightProcessor.abortCurrent();try{let i,s;e.type.startsWith("image/svg+xml")?(s=await async function(e){const t=new DOMParser,n=await Object(h.c)(e),o=t.parseFromString(n,"image/svg+xml"),i=o.documentElement;if(i.hasAttribute("width")&&i.hasAttribute("height"))return Object(h.b)(e);const s=i.getAttribute("viewBox");if(null===s)throw Error("SVG must have width/height or viewBox");const r=s.split(/\s+/);i.setAttribute("width",r[2]),i.setAttribute("height",r[3]);const a=(new XMLSerializer).serializeToString(o);return Object(h.b)(new Blob([a],{type:"image/svg+xml"}))}(e),i=Object(h.g)(s)):i=await Ct(e,n);const r=await Ht(i,Dt,n);if(this.state.loadingCounter!==t)return;let a=Object.assign({},this.state,{source:{decoded:i,file:e,vectorImage:s,processed:r,inputProcessorState:Dt},loading:!1});a=qt(a,a.source);for(const e of[0,1])a=$(a,`sides.${e}.latestSettings.preprocessorState.resize`,{width:r.width,height:r.height,method:s?"vector":"lanczos3"});this.updateDocumentTitle(e.name),this.setState(a)}catch(o){if("AbortError"===o.name)return;if(console.error(o),this.state.loadingCounter!==t)return;this.props.showSnack("Invalid image"),this.setState({loading:!1})}}queueUpdateImage(e,t={}){clearTimeout(this.updateImageTimeoutIds[e]),this.updateImageTimeoutIds[e]=self.setTimeout(()=>{this.updateImage(e,t).catch(e=>{console.error(e)})},100)}async updateImage(e,t={}){const{skipPreprocessing:n=!1}=t,{source:o}=this.state;if(!o)return;const i=this.state.sides[e].loadingCounter+1;let s=$(this.state.sides,e,{loadingCounter:i,loading:!0});this.setState({sides:s});const r=s[e],a=r.latestSettings;let c,h,u;const p=this.encodeCache.match(o.processed,a.preprocessorState,a.encoderState),d=0===e?this.leftProcessor:this.rightProcessor;if(d.abortCurrent(),p)({file:c,preprocessed:h,data:u}=p);else try{a.encoderState.type===Ve?(c=o.file,u=o.processed):(h=n&&r.preprocessed?r.preprocessed:await async function(e,t,n){let o=e.processed;if(t.resize.enabled)if("vector"===t.resize.method&&e.vectorImage)o=n.vectorResize(e.vectorImage,t.resize);else if(function(e){return"hqx"===e.method}(t.resize)){o=await n.workerResize(o,t.resize);const e=Object.assign({},t.resize,{method:"catrom"});o=await n.workerResize(o,e)}else o=Fe(t.resize)?await n.workerResize(o,t.resize):n.resize(o,t.resize);return t.quantizer.enabled&&(o=await n.imageQuant(o,t.quantizer)),o}(o,a.preprocessorState,d),c=await async function(e,t,n,o){const i=await(()=>{switch(t.type){case Ge:return o.oxiPngEncode(e,t.options);case ce:return o.mozjpegEncode(e,t.options);case xe:return o.webpEncode(e,t.options);case Ke:return o.avifEncode(e,t.options);case it.type:return o.browserPngEncode(e);case st.type:return o.browserJpegEncode(e,t.options);case rt.type:return o.browserWebpEncode(e,t.options);case at.type:return o.browserGifEncode(e);case ct.type:return o.browserTiffEncode(e);case lt.type:return o.browserJp2Encode(e);case ht.type:return o.browserBmpEncode(e);case ut.type:return o.browserPdfEncode(e);default:throw Error(`Unexpected encoder ${JSON.stringify(t)}`)}})(),s=pt[t.type];return new l.a([i],n.replace(/.[^.]*$/,`.${s.extension}`),{type:s.mimeType})}(h,a.encoderState,o.file.name,d),u=await Ct(c,d),this.encodeCache.add({data:u,preprocessed:h,file:c,sourceData:o.processed,encoderState:a.encoderState,preprocessorState:a.preprocessorState}))}catch(g){if("AbortError"===g.name)return;throw this.props.showSnack(`Processing error (type=${a.encoderState.type}): ${g}`),g}const b=this.state.sides[e];i<b.loadedCounter||(b.downloadUrl&&URL.revokeObjectURL(b.downloadUrl),s=$(this.state.sides,e,{file:c,data:u,preprocessed:h,downloadUrl:URL.createObjectURL(c),loading:s[e].loadingCounter!==i,loadedCounter:i,encodedSettings:a}),this.setState({sides:s}))}render({onBack:e},{loading:t,sides:n,source:o,mobileView:i}){const[s,r]=n,[a,l]=n.map(e=>e.data),h=n.map((e,t)=>Object(c.b)(mt,{source:o,mobileView:i,preprocessorState:e.latestSettings.preprocessorState,encoderState:e.latestSettings.encoderState,onEncoderTypeChange:this.onEncoderTypeChange.bind(this,t),onEncoderOptionsChange:this.onEncoderOptionsChange.bind(this,t),onPreprocessorOptionsChange:this.onPreprocessorOptionsChange.bind(this,t)})),p=i?["down","up"]:["right","left"],d=n.map((e,n)=>Object(c.b)(Mt,{downloadUrl:e.downloadUrl,imageFile:e.file,source:o,loading:t||e.loading,copyDirection:p[n],onCopyToOtherClick:this.onCopyToOtherClick.bind(this,n),buttonPosition:i?"stack-right":Wt[n]},i?[Object(c.b)(B,{class:u.expandIcon,key:"expand-icon"}),`${Ft[n]} (${pt[e.latestSettings.encoderState.type].label})`]:null)),b=s.encodedSettings||s.latestSettings,g=r.encodedSettings||r.latestSettings,f=b.preprocessorState.resize.enabled&&"contain"===b.preprocessorState.resize.fitMethod,m=g.preprocessorState.resize.enabled&&"contain"===g.preprocessorState.resize.fitMethod;return Object(c.b)("div",{class:u.compress},Object(c.b)(G,{source:o,mobileView:i,leftCompressed:a,rightCompressed:l,leftImgContain:f,rightImgContain:m,onBack:e,inputProcessorState:o&&o.inputProcessorState,onInputProcessorChange:this.onInputProcessorChange}),i?Object(c.b)("div",{class:u.options},Object(c.b)("multi-panel",{class:u.multiPanel,"open-one-only":!0},d[0],h[0],d[1],h[1])):[Object(c.b)("div",{class:u.options,key:"options0"},h[0],d[0]),Object(c.b)("div",{class:u.options,key:"options1"},h[1],d[1])])}}Bt([l.b],$t.prototype,"onMobileWidthChange",null),Bt([l.b],$t.prototype,"onInputProcessorChange",null),Bt([l.b],$t.prototype,"updateFile",null)}])]);
//# sourceMappingURL=main-app.b7c34.js.map